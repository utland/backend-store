## Основні відомості
+ **Назва**: Курсова робота. Back-end застосунок онлайн-магазину
+ **Опис**: Онлайн-магазин з товарами, де користувач має можливість продивлятися різні товари, додавати в їх кошик та робити нові замовлення.
+ **Виконавець**: Сизоненко Ілля (IM-43)

## Технологічний стек
+ **Мова програмування**: Typescript 5.7.3, фреймворк Nest.js
+ **ORM-бібліотека**: TypeOrm
+ **Testing framework**: Jest, Supertest

## Інструкції з використання
1. Клонуйте репозиторій
2. Запустіть сервіси: `docker-compose up`
3. Для запуску додатку виконайте команду `npm run start` або `npm run start:dev` для розробки
4. Для створення тестових даних використовуйте insert-скрипт в `/docs/insert-script.sql`

## Тестування
Для запуску усіх тестів необхідно виконати команди:
+  `npm run test` - для unit-тестів
+  `npm run test:e2e` - для інтеграційних тестів(e2e)

Щоб запустити конкретний тестовий файл або тест:
+  `npm tun test -- user.service` - запуск тестового файлу `user.service.spec.ts`
+  `npm tun test:e2e -- user.e2e` - запуск тестового файлу `user.e2e-spec.ts`
+  `npm tun test -- user.e2e -t createUser` - запуск тестів `createUser` у відповідному файлі

## Огляд структури 
```
store-backend/
│
├── docs/                      # Додаткова документація
│   ├── schema.md              # Пояснення схеми бази даних
│   ├── queries.md             # Складні запити з поясненнями
│
├── src/                       # Вихідний код
│   ├── auth/               
│   │   ├── auth.service.spec.ts     # Unit-тест
│   │   └── ...
│   │
│   ├── common/              
│   │   └── ...
│   │
│   ├── config/          
│   │   └── ...
│   └── ...            
│
├── test/                     # Тестові файли
│   ├── config/               # Конфігураційні файли
│   │   └── ...     #
│   └── jest.e2e-spec.ts/     # Налаштування Jest    
│   └── ...                   # E2E-тести
│
├── typeorm/               
│   ├── migrations          # Міграції бази даних
│   │   └── ...             
│   └── data-source.ts      # Налаштування міграцій
│
├── docker-compose.yml         # Конфігурація Docker
├── README.md                  # Основна документація
└── ...
```

## Приклади API

## User (Користувачі)

`/auth/register POST` - зареєструвати нового користувача \
`/auth/login POST` - увійти в обліковий запис користувача та отримати токен \

`/user/pass PATCH` - змінити пароль \
`/user/:userId GET` - отримати публічні дані користувача \
`/user/token GET` - отримати дані користувача за токеном \
`/user GET` - отримати усіх користувачів \
`/user PATCH` - змінити налаштування користувача за токеном \
`/user/:userId DELETE` - видалити користувача \
`/user/role/:userId PATCH` - змінити права доступу користувача \

`/cart/:productId POST` - додати товар у корзину користувача \
`/cart PATCH` - змінити товар у корзині \
`/cart/:productId DELETE` - видалити товар з корзини

## Product (Товари)

`POST /product` - створити новий товар (тільки Admin) \
`GET /product` - отримати список усіх товарів \
`GET /product/byCategory` - отримати товари за категорією (через query params) \
`GET /product/:id` - отримати деталі конкретного товару \
`PATCH /product/:id` - оновити дані товару (тільки Admin) \
`DELETE /product/:id` - видалити товар (тільки Admin) 

## Order (Замовлення)

`POST /order` - створити нове замовлення \
`GET /order` - отримати історію замовлень поточного користувача \
`GET /order/all` - отримати всі замовлення у системі (Admin, Moderator) \
`GET /order/:id` - отримати деталі конкретного замовлення (Admin або власник) \
`PATCH /order/status` - змінити статус замовлення (Admin, або User для скасування) \
`PATCH /order/address` - змінити адресу доставки в замовленні \
`DELETE /order/:id` - видалити замовлення (тільки Admin) 

## Category (Категорії)

`POST /category` - створити нову категорію (тільки Admin) \
`GET /category` - отримати список усіх категорій \
`GET /category/:id` - отримати категорію за ID \
`PATCH /category/:id` - оновити категорію (тільки Admin) \
`DELETE /category/:id` - видалити категорію (тільки Admin) 

## Supplier (Постачальники)

`GET /supplier/sales` - отримати статистику продажів за місяць (тільки Admin) \
`POST /supplier` - додати нового постачальника (тільки Admin) \
`GET /supplier` - отримати список усіх постачальників \
`GET /supplier/:id` - отримати дані постачальника за ID \
`PATCH /supplier/:id` - оновити дані постачальника (тільки Admin) \
`DELETE /supplier/:id` - видалити постачальника (тільки Admin) 

## Review (Відгуки)

`POST /review` - залишити відгук про товар \
`GET /review/:id` - отримати відгук за ID \
`PATCH /review/:id` - редагувати власний відгук \
`DELETE /review/:id` - видалити відгук (Admin або автор відгуку) 